skip_output:
  - meta
  - execution

pre-commit:
  piped: true
  commands:
    1-format:
      glob: "*.py"
      run: uv run black {staged_files} && uv run ruff check --fix {staged_files}
      stage_fixed: true
    2-check-style:
      glob: "*.py"
      run: uv run ruff check {staged_files} && uv run black --check {staged_files}
    3-check-type-hints:
      tags: slowpoke
      glob: "*.py"
      run: uv run mypy api/app api/settings api/tests && uv run mypy admin/app
    4-check-complexity:
      tags: slowpoke
      glob: "*.py"
      run: uv run flake8 {staged_files}

pre-push:
  parallel: true
  commands:
    1-check-style:
      glob: "*.py"
      run: uv run ruff check {all_files} && uv run black --check {all_files}
    2-check-type-hints:
      tags: slowpoke
      glob: "*.py"
      run: uv run mypy api/app api/settings api/tests && uv run mypy admin/app
    3-check-complexity:
      tags: slowpoke
      glob: "*.py"
      run: uv run flake8 {push_files}